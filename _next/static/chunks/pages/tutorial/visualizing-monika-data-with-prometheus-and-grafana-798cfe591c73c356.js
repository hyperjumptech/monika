(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[719],{5491:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tutorial/visualizing-monika-data-with-prometheus-and-grafana",function(){return a(3099)}])},3099:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h},meta:function(){return r}});var n=a(9534),o=(a(7294),a(3905)),s=a(2290),r={id:"visualizing-monika-data-with-prometheus-and-grafana",title:"Visualizing Monika Data with Prometheus and Grafana"},i={meta:r},l=function(e){var t=e.children,a=(0,n.Z)(e,["children"]);return(0,o.kt)(s.C,Object.assign({meta:r},a),t)};function h(e){var t=e.components,a=(0,n.Z)(e,["components"]);return(0,o.kt)(l,Object.assign({},i,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("a",Object.assign({parentName:"p"},{href:"https://grafana.com/"}),"Grafana")," is an open source visualization and analytics software. It allows you to query, visualize, be alerted, and explore your metrics no matter where they are stored. In plain English, it provides you with tools to turn your time-series database (TSDB) data into beautiful graphs and visualizations. It will be used to visualize your Monika data that has been processed by Prometheus."),(0,o.kt)("h2",Object.assign({},{id:"install-grafana"}),"Install Grafana",(0,o.kt)("a",Object.assign({parentName:"h2"},{href:"#install-grafana",title:"Direct link to heading",className:"anchor"}),(0,o.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,o.kt)("p",null,"Let\u2019s assume that you already have Monika and Prometheus installed and connected. The next step is we need to install Grafana. Head to the ",(0,o.kt)("a",Object.assign({parentName:"p"},{href:"https://grafana.com/grafana/download?pg=oss-graf&plcmt=hero-btn-1"}),"Downloads page")," and select which OS you are using."),(0,o.kt)("img",Object.assign({},{src:"https://miro.medium.com/max/1400/1*CIKeZbmC8OepT1whxy_t5A.png",alt:null})),(0,o.kt)("p",null,"After you installed Grafana, open your web browser and go to ",(0,o.kt)("a",Object.assign({parentName:"p"},{href:"http://localhost:3000/."}),"http://localhost:3000/.")," The default HTTP port that Grafana listens to is 3000 unless you have configured a different port. It should show you the login page. On the login page, enter admin for username and password. After you are logged in, you will see the prompt to change your default password. Change your default password, and submit. You are now on the Grafana home page."),(0,o.kt)("img",Object.assign({},{src:"https://miro.medium.com/max/1400/1*QcOWmhKE1CvnMISEqJkAfQ.png",alt:null})),(0,o.kt)("h2",Object.assign({},{id:"configure-the-data-source"}),"Configure the Data Source",(0,o.kt)("a",Object.assign({parentName:"h2"},{href:"#configure-the-data-source",title:"Direct link to heading",className:"anchor"}),(0,o.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,o.kt)("p",null,"Before we configure the data source, we need to run Monika and Prometheus. In case you forgot, here are the commands to run Monika and Prometheus both locally or using Docker:"),(0,o.kt)("pre",null,(0,o.kt)("code",Object.assign({parentName:"pre"},{}),"_\\# Run Monika\n\\# If you're installing Monika locally_\n**monika -c monika.json --prometheus 3001**_\\# Or if you're using Docker_\n**docker run --name monika \\\\\n    -p 3001:3001 \\\\\n    -v ${PWD}/monika.json:/config/monika.json \\\\\n    --prometheus 3001 \\\\\n    --detach hyperjump/monika:latest**_\\# Run Prometheus\n\\# If you're installing Prometheus locally_\n**./prometheus --config.file=prometheus.yml**_\\# Or if you're using Docker_\n**docker run -d --name prometheus \\\\\n    -p 9090:9090 \\\\\n    -v <PATH\\_TO\\_prometheus.yml>:/etc/prometheus/prometheus.yml \\\\\n    prom/prometheus --config.file=/etc/prometheus/prometheus.yml**\n")),(0,o.kt)("p",null,"Back to the Grafana home page. On the left sidebar, hover the gear icon and select the Data Source option. Add a new data source by clicking the blue \u201cAdd data source\u201d button. Then, select Prometheus as your data source."),(0,o.kt)("img",Object.assign({},{src:"https://miro.medium.com/max/1400/1*yfk-3lk4jpQuab-izUO2jw.png",alt:null})),(0,o.kt)("p",null,"If you are following the instructions from the previous article, you are running Prometheus in port 9090. Fill out the URL with ",(0,o.kt)("a",Object.assign({parentName:"p"},{href:"http://localhost:9090"}),"http://localhost:9090")," and click the Save and Test button. It should display a toast notification telling that the data source has been updated."),(0,o.kt)("img",Object.assign({},{src:"https://miro.medium.com/max/1400/1*HmTBocHPyw8BDFqqoWLzlA.png",alt:null})),(0,o.kt)("h2",Object.assign({},{id:"creating-the-dashboard"}),"Creating the Dashboard",(0,o.kt)("a",Object.assign({parentName:"h2"},{href:"#creating-the-dashboard",title:"Direct link to heading",className:"anchor"}),(0,o.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,o.kt)("p",null,"After the data source has been successfully added, hover over the plus icon sub-menu and select the Dashboard option. And then, click the \u201cAdd an Empty Panel\u201d area. We are now going to create a probe status code information panel."),(0,o.kt)("img",Object.assign({},{src:"https://miro.medium.com/max/1400/1*qwQWyb3ts9Uhuxi_T1eH1w.png",alt:null})),(0,o.kt)("p",null,"You are now on the edit panel page. In the right top section of the page, change the \u201cTime Series\u201d dropdown to \u201cStat\u201d. Then, navigate to the metrics browser input field, type monika_request_status_code_infoand press Shift + Enter. After that, on the right sidebar, change the Panel Title to \u201cProbe Status Code\u201d and scroll down to the Threshold section. Set the color red threshold to 500. Now it should look like this:"),(0,o.kt)("img",Object.assign({},{src:"https://miro.medium.com/max/1400/1*dpn6IPBCk5L8cc-HxfZLpg.png",alt:null})),(0,o.kt)("p",null,"Apply the changes, and we are halfway done. Next, we are going to create another panel for monitoring the average response time per 5 minutes."),(0,o.kt)("p",null,"Create another panel in the current dashboard. Navigate to the metrics browser input field, type this in one line, and press Shift + Enter:"),(0,o.kt)("pre",null,(0,o.kt)("code",Object.assign({parentName:"pre"},{}),"rate(monika\\_request\\_response\\_time\\_seconds\\_sum\\[5m\\]) / rate(monika\\_request\\_response\\_time\\_seconds\\_count\\[5m\\])\n")),(0,o.kt)("p",null,"After that, on the right sidebar, change the Panel Title to \u201cProbe Average Response Time\u201d. Then on the right sidebar, scroll down to the \u201cStandard Options\u201d section and change the unit to \u201cMilliseconds\u201d. Apply the changes, and you\u2019re done!"),(0,o.kt)("img",Object.assign({},{src:"https://miro.medium.com/max/1400/1*nwUc_Qe-ms1C0gAQ2h1qDA.png",alt:null})),(0,o.kt)("img",Object.assign({},{src:"https://miro.medium.com/max/1400/1*xvztYWCgyj7Z-XHkJMzFhw.png",alt:null})),(0,o.kt)("p",null,"Congratulations! Now that you have successfully integrated Monika with Prometheus and Grafana, you will be notified if your website is slow or down."))}h.isMDXComponent=!0}},function(e){e.O(0,[357,513,290,774,888,179],(function(){return t=5491,e(e.s=t);var t}));var t=e.O();_N_E=t}]);