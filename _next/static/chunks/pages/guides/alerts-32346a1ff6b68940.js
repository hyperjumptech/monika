(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[209],{4996:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/guides/alerts",function(){return a(8681)}])},8681:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p},meta:function(){return l}});a(7294);var n=a(3905),s=a(8470);function r(e,t){if(null==e)return{};var a,n,s=function(e,t){if(null==e)return{};var a,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}var l={id:"alerts",title:"Alerts"},i={meta:l},o=function(e){var t=e.children,a=r(e,["children"]);return(0,n.kt)(s.C,Object.assign({meta:l},a),t)};function p(e){var t=e.components,a=r(e,["components"]);return(0,n.kt)(o,Object.assign({},i,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Alerts are the types of conditions that will trigger Monika to send notifications. It is an array defined in the config file ",(0,n.kt)("inlineCode",{parentName:"p"},"monika.yml")," like so."),(0,n.kt)("pre",null,(0,n.kt)("code",Object.assign({parentName:"pre"},{className:"language-yaml"}),"probes:\n  - id: '1'\n    name: Name of the probe\n    requests:\n      - method: GET\n        url: https://github.com\n        alerts:\n          - assertion: response.size >= 10000\n            message: Response size is {{ response.size }}, expecting less than 10000\n")),(0,n.kt)("p",null,"You can define two types of alerts: ",(0,n.kt)("strong",{parentName:"p"},"request alerts")," and ",(0,n.kt)("strong",{parentName:"p"},"probe alerts")),(0,n.kt)("h2",Object.assign({},{id:"request-alerts"}),"Request Alerts",(0,n.kt)("a",Object.assign({parentName:"h2"},{href:"#request-alerts",title:"Direct link to heading",className:"anchor"}),(0,n.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,n.kt)("p",null,"Request alerts are ",(0,n.kt)("inlineCode",{parentName:"p"},"alerts")," configurations that are scoped under the ",(0,n.kt)("inlineCode",{parentName:"p"},"requests")," key. Alerts defined under a specific request will run for that specific request only. Take a look at the example below:"),(0,n.kt)("pre",null,(0,n.kt)("code",Object.assign({parentName:"pre"},{className:"language-yaml"}),"probes:\n  - id: '1'\n    name: Name of the probe\n    requests:\n      - method: GET\n        url: https://github.com\n        alerts:\n          - assertion: response.status != 200\n            message: Status not 2xx # (This alert is only triggered for the github.com request)\n      - method: GET\n        url: https://gitlab.com\n        alerts:\n          - assertion: response.status != 200\n            message: Status not 2xx # (This alert is only triggered for the gitlab.com request)\n")),(0,n.kt)("h2",Object.assign({},{id:"probe-alerts"}),"Probe Alerts",(0,n.kt)("a",Object.assign({parentName:"h2"},{href:"#probe-alerts",title:"Direct link to heading",className:"anchor"}),(0,n.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,n.kt)("p",null,"Probe alerts are ",(0,n.kt)("inlineCode",{parentName:"p"},"alerts")," configurations that are defined under the ",(0,n.kt)("inlineCode",{parentName:"p"},"probe")," key. Alerts scoped under the probe key will run for all requests for that probe. Take a look at the example below:"),(0,n.kt)("pre",null,(0,n.kt)("code",Object.assign({parentName:"pre"},{className:"language-yaml"}),"probes:\n  - id: '1'\n    name: Name of the probe\n    requests:\n      - method: GET\n        url: https://github.com\n        alerts:\n          - assertion: response.status != 200\n            message: Status not 2xx # (This alert is only triggered for the github.com request)\n      - method: GET\n        url: https://gitlab.com\n        alerts:\n          - assertion: response.status != 200\n            message: Status not 2xx # (This alert is only triggered for the gitlab.com request)\n    alerts:\n      - assertion: response.time > 10000 # in milliseconds\n        message: Response time is longer than 10 seconds # (This alert is triggered for all request)\n")),(0,n.kt)("h2",Object.assign({},{id:"alert-timing"}),"Alert Timing",(0,n.kt)("a",Object.assign({parentName:"h2"},{href:"#alert-timing",title:"Direct link to heading",className:"anchor"}),(0,n.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,n.kt)("p",null,"Probes are performed after every interval, and alerts are generated after a specified threshold. Monika can perform probes once a second, therefore a theoretical maximum rate of one alert a second. Please keep in mind that there may be some delays to your network, notification channels (slack, email, etc), so your result will vary."),(0,n.kt)("p",null,"In general it will be something like:"),(0,n.kt)("pre",null,(0,n.kt)("code",Object.assign({parentName:"pre"},{className:"language-text"}),"Alert resolution = interval period (s) x threshold + network_and_channel_latencies\n")),(0,n.kt)("p",null,"From above, the theoretical maximum resolution is one second."),(0,n.kt)("h2",Object.assign({},{id:"alert-assertion"}),"Alert Assertion",(0,n.kt)("a",Object.assign({parentName:"h2"},{href:"#alert-assertion",title:"Direct link to heading",className:"anchor"}),(0,n.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,n.kt)("p",null,"Assertion contains any arbitrary expression that will trigger alert when it returns a truthy value"),(0,n.kt)("pre",null,(0,n.kt)("code",Object.assign({parentName:"pre"},{className:"language-yaml"}),"alerts:\n  - assertion: response.status == 500\n")),(0,n.kt)("p",null,"Inside the assertion expression you can get the response object."),(0,n.kt)("p",null,"These are values that are available:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"response.status: HTTP status code of the response"),(0,n.kt)("li",{parentName:"ul"},"response.time: the time it takes to perform a HTTP request"),(0,n.kt)("li",{parentName:"ul"},"response.size: size of the response in bytes"),(0,n.kt)("li",{parentName:"ul"},"response.headers: HTTP response headers"),(0,n.kt)("li",{parentName:"ul"},"response.body: HTTP response body (if content-type is JSON, it will be parsed automatically)")),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"response.headers")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"response.body")," can be queried further with object access syntax."),(0,n.kt)("p",null,"For example, to trigger alert when content-type is not json you may use"),(0,n.kt)("pre",null,(0,n.kt)("code",Object.assign({parentName:"pre"},{className:"language-yaml"}),"alerts:\n  - assertion: response.headers['content-type'] != \"application/json\"\n")),(0,n.kt)("p",null,"Or to assertion value inside the body"),(0,n.kt)("pre",null,(0,n.kt)("code",Object.assign({parentName:"pre"},{className:"language-yaml"}),'alerts:\n  - assertion: response.body.data.todos[0].title != "Drink water"\n')),(0,n.kt)("p",null,"Additionally you can have processing done in your queries. For instance, to ensure case insensitivity, you might want to convert to lowercase. It might look something like this:"),(0,n.kt)("pre",null,(0,n.kt)("code",Object.assign({parentName:"pre"},{className:"language-yaml"}),'alerts:\n  - assertion: has(lowerCase(response.body.status), "success")\n')),(0,n.kt)("p",null,"These operators are available:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",Object.assign({parentName:"tr"},{align:null}),"Numeric arithmetic"),(0,n.kt)("th",Object.assign({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x + y"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Add")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x - y"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Subtract")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x ","*"," y"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Multiply")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x / y"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Divide")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x % y"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Modulo")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x ^ y"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Power")))),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",Object.assign({parentName:"tr"},{align:null}),"Comparisons"),(0,n.kt)("th",Object.assign({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x == y"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Equals")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x != y"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Does not equal")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x < y"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Less than")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x <= y"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Less than or equal to")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x > y"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Greater than")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x >= y"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Greater than or equal to")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x ~= y"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Regular expression match")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x in (a, b, c)"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Equivalent to (x == a or x == b or x == c)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x not in (a, b, c)"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Equivalent to (x != a and x != b and x != c)")))),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",Object.assign({parentName:"tr"},{align:null}),"Boolean logic"),(0,n.kt)("th",Object.assign({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x or y"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Boolean or")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x and y"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Boolean and")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"not x"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Boolean not")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"x ? y : z"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"If boolean x, value y, else z")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"( x )"),(0,n.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Explicit operator precedence")))),(0,n.kt)("p",null,"There are also several helper functions available:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"has(object, property)"),": Checks whether an object has searched property."),(0,n.kt)("p",{parentName:"li"},"example: ",(0,n.kt)("inlineCode",{parentName:"p"},'has(response.body, "data")'),' checks if there is "data" property inside response.body')),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"lowerCase(string)"),": Converts string to lowercase"),(0,n.kt)("p",{parentName:"li"},"example: ",(0,n.kt)("inlineCode",{parentName:"p"},"lowerCase(response.body.message)")," converts message string value to lowercase")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"upperCase(string)"),": Converts string to uppercase"),(0,n.kt)("p",{parentName:"li"},"example: ",(0,n.kt)("inlineCode",{parentName:"p"},"upperCase(response.body.message)")," converts message string value to uppercase")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"startsWith(string, target)"),": Checks if string starts with the given target string"),(0,n.kt)("p",{parentName:"li"},"example: ",(0,n.kt)("inlineCode",{parentName:"p"},'startsWith(response.body.message, "Hello")'),' checks if message string value starts with "Hello"')),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"endsWith(string, target)"),": Checks if string ends with the given target string"),(0,n.kt)("p",{parentName:"li"},"example: ",(0,n.kt)("inlineCode",{parentName:"p"},'startsWith(response.body.message, "world!")'),' checks if message string value ends with "world!"')),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"includes(collection, value)"),": Checks if value is in collection. If collection is a string, it's checked for a substring of value"),(0,n.kt)("p",{parentName:"li"},"example 1: ",(0,n.kt)("inlineCode",{parentName:"p"},'includes(response.body.prizes, "gold")'),' checks if "gold" exists in the prizes array.'),(0,n.kt)("p",{parentName:"li"},"example 2: ",(0,n.kt)("inlineCode",{parentName:"p"},'includes(response.body.message, "ello")'),' checks if "ello" is a substring of the message string.')),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"size(collection)"),": Gets length of array or string values."),(0,n.kt)("p",{parentName:"li"},"example: ",(0,n.kt)("inlineCode",{parentName:"p"},"size(response.body.data.items)")," gets the count of items.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"isEmpty(value)"),": Checks if value is an empty object, empty array, empty string, null, or undefined."),(0,n.kt)("p",{parentName:"li"},"example: ",(0,n.kt)("inlineCode",{parentName:"p"},"isEmpty(response.body.data)")," checks whether the data property is empty or not"))),(0,n.kt)("h2",Object.assign({},{id:"alert-message"}),"Alert Message",(0,n.kt)("a",Object.assign({parentName:"h2"},{href:"#alert-message",title:"Direct link to heading",className:"anchor"}),(0,n.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,n.kt)("pre",null,(0,n.kt)("code",Object.assign({parentName:"pre"},{className:"language-yaml"}),"alerts:\n  - assertion: response.status != 200\n    message: HTTP Status code is different, expecting 200\n")),(0,n.kt)("p",null,"This is the message that is used in the sent notification."),(0,n.kt)("p",null,"Inside the message string, you can also get the response object similar to assertion by surrounding the expression with double curly braces like the example above."),(0,n.kt)("h2",Object.assign({},{id:"built-in-alerts"}),"Built-in Alerts",(0,n.kt)("a",Object.assign({parentName:"h2"},{href:"#built-in-alerts",title:"Direct link to heading",className:"anchor"}),(0,n.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,n.kt)("p",null,"Monika will automatically issue an alert when it detects a probe is inaccessible. An incident and recovery alert will be sent to all configured notification channels. Note that explicit connection assertion and customized message strings are not yet supported."),(0,n.kt)("h2",Object.assign({},{id:"further-reading"}),"Further reading",(0,n.kt)("a",Object.assign({parentName:"h2"},{href:"#further-reading",title:"Direct link to heading",className:"anchor"}),(0,n.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("a",Object.assign({parentName:"li"},{href:"./probes"}),"Probes")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("a",Object.assign({parentName:"li"},{href:"./notifications"}),"Notifications"))))}p.isMDXComponent=!0}},function(e){e.O(0,[547,778,470,774,888,179],(function(){return t=4996,e(e.s=t);var t}));var t=e.O();_N_E=t}]);