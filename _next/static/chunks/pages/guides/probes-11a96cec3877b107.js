(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[621],{9021:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/guides/probes",function(){return n(1174)}])},1174:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p},meta:function(){return r}});n(7294);var a=n(3905),i=n(3957);function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var r={id:"probes",title:"Probes"},o={meta:r},l=function(e){var t=e.children,n=s(e,["children"]);return(0,a.kt)(i.C,Object.assign({meta:r},n),t)};function p(e){var t=e.components,n=s(e,["components"]);return(0,a.kt)(l,Object.assign({},o,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Probes are the heart of the monitoring requests. Probes are arrays of request objects defined in the config file ",(0,a.kt)("inlineCode",{parentName:"p"},"monika.yml")," like so."),(0,a.kt)("pre",null,(0,a.kt)("code",Object.assign({parentName:"pre"},{className:"language-yaml"}),"probes:\n  - id: '1'\n    name: Name of the probe\n    description: Probe to check GET time\n    interval: 10\n    requests:\n      - {}\n    alerts: []\n  - id: '2'\n    name: Name of the probe 2\n    description: Probe to check GET health\n    interval: 10\n    requests:\n      - {}\n    alerts: []\n")),(0,a.kt)("p",null,"Monika goes through each probe object, sends it out, and determines whether an alert or notification needs to be sent out."),(0,a.kt)("h2",Object.assign({},{id:"probe-request-anatomy"}),"Probe Request Anatomy",(0,a.kt)("a",Object.assign({parentName:"h2"},{href:"#probe-request-anatomy",title:"Direct link to heading",className:"anchor"}),(0,a.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,a.kt)("p",null,"An actual probe request may be something like below."),(0,a.kt)("pre",null,(0,a.kt)("code",Object.assign({parentName:"pre"},{className:"language-yaml"}),"  probes: [\n    id: '1'\n    name: 'Example: get Time'\n    description: Probe\n    interval: 10\n    requests:\n    - method: POST\n      url: https://mybackend.org/user/login\n      timeout: 7000\n      saveBody: true\n      headers:\n        Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkhlbGxvIGZyb20gSHlwZXJqdW1wIiwiaWF0IjoxNTE2MjM5MDIyfQ.T2SbP1G39CMD4MMfkOZYGFgNIQgNkyi0sPdiFi_DfVA\n      body:\n        username: someusername\n        password: somepassword\n      alerts: ARRAY-HERE\n    incidentThreshold: 3\n    recoveryThreshold: 3\n    alerts:\n    - query: response.status != 200\n      message: HTTP response status is {{ response.status }}, expecting 200\n  ]\n")),(0,a.kt)("p",null,"Details of the field are given in the table below."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",Object.assign({parentName:"tr"},{align:"left"}),"Topic"),(0,a.kt)("th",Object.assign({parentName:"tr"},{align:null}),"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"method"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Http method such as GET, POST, PUT, DELETE.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"url"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"This is the url endpoint to dispatch the request to.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"timeout"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Request timeout, after which time, ",(0,a.kt)("inlineCode",{parentName:"td"},"Monika")," will assume timeout.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"headers"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Http headers you might need for your request.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"body"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Any http body if your method requires it.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"interval (optional)"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Number of probe's interval (in seconds). Default value is 10 seconds.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"incidentThreshold (optional)"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Number of times an alert should return true before Monika sends notifications. For example, when incidentThreshold is 3, Monika will only send notifications when the probed URL returns non-2xx status 3 times in a row. After sending the notifications, Monika will not send notifications anymore until the alert status changes. Default value is 5.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"recoveryThreshold (optional)"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Number of times an alert should return false before Monika sends notifications. For example, when recoveryThreshold is 3, Monika will only send notifications when the probed URL returns status 2xx 3 times in a row. After sending the notifications, Monika will not send notifications anymore until the alert status changes. Default value is 5.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"alerts"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"The condition which will trigger an alert, and the subsequent notification method to send out the alert. See below for further details on alerts and notifications.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"saveBody (optional)"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"When set to true, the response body of the request is stored in the internal database. The default is off when not defined. This is to keep the log file size small as some responses can be sizable. The setting is for each probe request.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"alerts (optional)"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"See ",(0,a.kt)("a",Object.assign({parentName:"td"},{href:"./alerts"}),"alerts")," section for detailed information.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"ping (optional)"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"(boolean), If set true then send a PING to the specified url instead.")))),(0,a.kt)("h3",Object.assign({},{id:"ping"}),"PING",(0,a.kt)("a",Object.assign({parentName:"h3"},{href:"#ping",title:"Direct link to heading",className:"anchor"}),(0,a.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,a.kt)("p",null,"You can send an ICMP echo request to a specific url by enabling the ",(0,a.kt)("inlineCode",{parentName:"p"},"ping: true")," field.\nIn this mode the http method is ignored and a PING echo request is sent to the specified url."),(0,a.kt)("pre",null,(0,a.kt)("code",Object.assign({parentName:"pre"},{className:"language-yaml"}),"probes:\n  - id: 'ping_test'\n    name: ping_test\n    description: requesting icmp ping\n    interval: 10\n    requests:\n      - url: http://google.com\n        ping: true\n")),(0,a.kt)("h3",Object.assign({},{id:"tcp"}),"TCP",(0,a.kt)("a",Object.assign({parentName:"h3"},{href:"#tcp",title:"Direct link to heading",className:"anchor"}),(0,a.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,a.kt)("p",null,"You can send a TCP request to a specific ",(0,a.kt)("inlineCode",{parentName:"p"},"host")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"port")," with ",(0,a.kt)("inlineCode",{parentName:"p"},"data")," by using the ",(0,a.kt)("inlineCode",{parentName:"p"},"socket")," field."),(0,a.kt)("pre",null,(0,a.kt)("code",Object.assign({parentName:"pre"},{className:"language-yaml"}),"probes:\n  - id: 'tcp-example'\n    socket:\n      host: localhost\n      port: 3333\n      data: Hello from Monika\n")),(0,a.kt)("h2",Object.assign({},{id:"probe-response-anatomy"}),"Probe Response Anatomy",(0,a.kt)("a",Object.assign({parentName:"h2"},{href:"#probe-response-anatomy",title:"Direct link to heading",className:"anchor"}),(0,a.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,a.kt)("p",null,"The default shape of a response when Monika has successfully fetched a request is as the following."),(0,a.kt)("pre",null,(0,a.kt)("code",Object.assign({parentName:"pre"},{className:"language-yaml"}),"status: 200\nstatusText: OK\nheaders:\n  test-header: ...\nconfig:\n  url: https://reqres.in/api/users\n  method: GET\n  data:\n    mydata: value\n  headers:\n    Accept: application/json, text/plain, */*\n    User-Agent: axios/0.21.1\ndata: ...\n")),(0,a.kt)("p",null,"Details of the fields are shown in the table below."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",Object.assign({parentName:"tr"},{align:"left"}),"Topic"),(0,a.kt)("th",Object.assign({parentName:"tr"},{align:null}),"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"status"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"HTTP Status Code (e.g 200, 403, 500)")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"statusText"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"HTTP Status Code Explanation (e.g OK, Forbidden, Internal Server Error)")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"config"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Request configuration (e.g URL, Method, Data, Headers, Body, etc.)")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"headers"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Response headers from the fetched request (e.g SetCookie, ETag, etc.).")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",Object.assign({parentName:"tr"},{align:"left"}),"data"),(0,a.kt)("td",Object.assign({parentName:"tr"},{align:null}),"Response payload from the fetched request (e.g token, results, data).")))),(0,a.kt)("p",null,"Probe response data could be used for ",(0,a.kt)("a",Object.assign({parentName:"p"},{href:"https://hyperjumptech.github.io/monika/guides/examples#requests-chaining"}),"Request Chaining"),"."),(0,a.kt)("h2",Object.assign({},{id:"execution-order"}),"Execution order",(0,a.kt)("a",Object.assign({parentName:"h2"},{href:"#execution-order",title:"Direct link to heading",className:"anchor"}),(0,a.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,a.kt)("p",null,"In a configuration with multiple probes, ",(0,a.kt)("inlineCode",{parentName:"p"},"Monika")," will load the requests in the order that they are entered, one after another. However, probes may be performed out of sequence depending on their interval setting, network latency and response times. By default Monika loops through all the probe configurations in the order they are entered, but you can use the ",(0,a.kt)("inlineCode",{parentName:"p"},"--id")," or the ",(0,a.kt)("inlineCode",{parentName:"p"},"--repeat")," flags to specify or repeat a particular sequence. See the ",(0,a.kt)("a",Object.assign({parentName:"p"},{href:"https://monika.hyperjump.tech/guides/cli-options"}),"cli options here")," for more information."),(0,a.kt)("p",null,"In general, Monika will sleep until the next ",(0,a.kt)("inlineCode",{parentName:"p"},"interval")," timer to repeat a probe. If no ",(0,a.kt)("inlineCode",{parentName:"p"},"interval")," time is specified for a probe, the default value will be used. If the configured probe ",(0,a.kt)("inlineCode",{parentName:"p"},"interval")," is shorter than the amount of time to dispatch all the requests, then ",(0,a.kt)("inlineCode",{parentName:"p"},"Monika")," will immediately repeat after the last response and any notification alerts sent."),(0,a.kt)("h2",Object.assign({},{id:"content-type-header"}),"Content-Type header",(0,a.kt)("a",Object.assign({parentName:"h2"},{href:"#content-type-header",title:"Direct link to heading",className:"anchor"}),(0,a.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,a.kt)("p",null,"Currently, Monika only supports Content-Type value ",(0,a.kt)("inlineCode",{parentName:"p"},"application/x-www-form-urlencoded")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"application/json")," with UTF-8 encoding."),(0,a.kt)("h2",Object.assign({},{id:"request-body"}),"Request Body",(0,a.kt)("a",Object.assign({parentName:"h2"},{href:"#request-body",title:"Direct link to heading",className:"anchor"}),(0,a.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,a.kt)("p",null,"By default, the request body will be treated as-is. If the request header's ",(0,a.kt)("inlineCode",{parentName:"p"},"Content-Type")," is set to ",(0,a.kt)("inlineCode",{parentName:"p"},"application/x-www-form-urlencoded"),", it will be serialized into URL-safe string in UTF-8 encoding."),(0,a.kt)("h2",Object.assign({},{id:"postman-json-file-support"}),"Postman JSON file support",(0,a.kt)("a",Object.assign({parentName:"h2"},{href:"#postman-json-file-support",title:"Direct link to heading",className:"anchor"}),(0,a.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"NOTE: We only support Postman collection v2.0 and v2.1 files.")),(0,a.kt)("p",null,"To run monika using a ",(0,a.kt)("a",Object.assign({parentName:"p"},{href:"https://www.postman.com/"}),"Postman")," JSON file, use ",(0,a.kt)("inlineCode",{parentName:"p"},"--postman")," flag as follows:"),(0,a.kt)("pre",null,(0,a.kt)("code",Object.assign({parentName:"pre"},{className:"language-bash"}),"monika --postman <path_to_postman_file>\n")),(0,a.kt)("h2",Object.assign({},{id:"insomnia-file-support"}),"Insomnia file support",(0,a.kt)("a",Object.assign({parentName:"h2"},{href:"#insomnia-file-support",title:"Direct link to heading",className:"anchor"}),(0,a.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,a.kt)("p",null,"Monika supports ",(0,a.kt)("a",Object.assign({parentName:"p"},{href:"https://insomnia.rest/"}),"Insomnia")," collection file in ",(0,a.kt)("strong",{parentName:"p"},"version 4")," format. Both ",(0,a.kt)("inlineCode",{parentName:"p"},"json")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"yaml")," files are supported.\nTo run Monika using an Insomnia collection file, use ",(0,a.kt)("inlineCode",{parentName:"p"},"--insomnia")," flag as follows:"),(0,a.kt)("pre",null,(0,a.kt)("code",Object.assign({parentName:"pre"},{className:"language-bash"}),"monika --insomnia <path_to_insomnia_file>\n")),(0,a.kt)("h2",Object.assign({},{id:"har-file-support"}),"HAR file support",(0,a.kt)("a",Object.assign({parentName:"h2"},{href:"#har-file-support",title:"Direct link to heading",className:"anchor"}),(0,a.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,a.kt)("p",null,"HAR ",(0,a.kt)("a",Object.assign({parentName:"p"},{href:"https://en.wikipedia.org/wiki/HAR_(file_format)"}),"HTTP-Archive")," format was created by the Web Performance Working Group and has become the standard in browser archive request data definition. To run monika using a HAR file, use ",(0,a.kt)("inlineCode",{parentName:"p"},"--har")," flag as follows:"),(0,a.kt)("pre",null,(0,a.kt)("code",Object.assign({parentName:"pre"},{className:"language-bash"}),"monika --har <path_to_HAR_file>\n")),(0,a.kt)("h2",Object.assign({},{id:"further-reading"}),"Further reading",(0,a.kt)("a",Object.assign({parentName:"h2"},{href:"#further-reading",title:"Direct link to heading",className:"anchor"}),(0,a.kt)("span",Object.assign({parentName:"a"},{className:"icon icon-link"})))),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",Object.assign({parentName:"li"},{href:"./alerts"}),"Alerts")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",Object.assign({parentName:"li"},{href:"./notifications"}),"Notifications"))))}p.isMDXComponent=!0}},function(e){e.O(0,[547,50,957,774,888,179],(function(){return t=9021,e(e.s=t);var t}));var t=e.O();_N_E=t}]);